http://aria42.com/blog/2014/12/understanding-lbfgs/