package org.aja.tej.examples.dataset

import org.apache.spark.SparkContext
import org.apache.spark.graphx._
import org.apache.spark.rdd._

/**
 * Created by mageswaran on 25/3/16.
 */

/**
A history of e-mails that are exchanged within an organization
can be mapped to a communication graph, so as to understand the informal structure
behind the organization. Such graphs can also be used to determine influential people
or the hubs of the organization that might not necessarily be the high-ranked ones.
The email communication network is a canonical example of a directed graph, as each
e-mail links a source node to the destination node. We will use the Enron Corpus,
which is a database of e-mails generated by 158 employees of the Enron Corporation.
It is one of the only mass collections of corporate e-mails that are open to public on the
web. The Enron Corpus is particularly interesting, as it captures all the communication
that occurred inside the company before the scandal that led to its bankruptcy. The
original dataset was released by William Cohen at CMU, which can be downloaded
from https://www.cs.cmu.edu/~./enron/. A detailed description of the complete
dataset was done by Klimmt and Yang, 2004. A cleaner version of the dataset,
which we use here, is provided by Leskovec et al., 2009, and can be obtained
from https://snap.stanford.edu/data/email-Enron.html.
  */
object EnrollEmailDS {

  //Assuming the application has already initialized the context
  var sc:SparkContext = SparkContext.getOrCreate()
  val path = "data/graphx/enron_email/emailEnron.txt"

  val rdd = sc.textFile(path)
  val emailGraph = GraphLoader.edgeListFile(sc, path)

  val emailGraphPartitioned = GraphLoader.edgeListFile(sc, path).
    subgraph(epred = t => t.srcId < t.dstId).
    partitionBy(PartitionStrategy.RandomVertexCut)

}
